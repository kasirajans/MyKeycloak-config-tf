# Unified Keycloak Realms Configuration
# This file defines multiple realms that will be created/managed by Terraform

realms:
  - name: "idp-customer"
    display_name: "Identity Provider Customer"
    display_name_html: "<b>Identity Provider Customer</b>"
    enabled: true
    
    # Login Settings
    login_with_email_allowed: true
    registration_allowed: false
    registration_email_as_username: true
    reset_password_allowed: true
    remember_me: true
    verify_email: false
    edit_username_allowed: false
    duplicate_emails_allowed: false
    
    # Session Settings (in seconds)
    sso_session_idle_timeout: 1800        # 30 minutes
    sso_session_max_lifespan: 36000       # 10 hours
    offline_session_idle_timeout: 2592000 # 30 days
    offline_session_max_lifespan: 5184000 # 60 days
    access_token_lifespan: 300            # 5 minutes
    
    # Security Settings
    ssl_required: "external"
    password_policy: "upperCase(1) and length(8) and digits(1) and notUsername"
    revoke_refresh_token: true
    refresh_token_max_reuse: 0
    
    # Internationalization
    supported_locales:
      - "en"
      - "es"
      - "fr"
      - "de"
    default_locale: "en"
    
    # Security Defenses
    security_defenses:
      headers:
        x_frame_options: "SAMEORIGIN"
        content_security_policy: "frame-src 'self'; frame-ancestors 'self'; object-src 'none';"
        x_content_type_options: "nosniff"
        x_robots_tag: "none"
        x_xss_protection: "1; mode=block"
        strict_transport_security: "max-age=31536000; includeSubDomains"
      brute_force:
        permanent_lockout: false
        max_login_failures: 5
        wait_increment_seconds: 60
        quick_login_check_milli_seconds: 1000
        minimum_quick_login_wait_seconds: 60
        max_failure_wait_seconds: 900
        failure_reset_time_seconds: 43200
    
    # Browser Flows
    browser_flow: "browser"
    registration_flow: "registration"
    direct_grant_flow: "direct grant"
    reset_credentials_flow: "reset credentials"
    client_authentication_flow: "clients"

  - name: "sp-customer"
    display_name: "Service Provider Customer"
    display_name_html: "<b>Service Provider Customer</b>"
    enabled: true
    
    # Login Settings
    login_with_email_allowed: true
    registration_allowed: false
    registration_email_as_username: true
    reset_password_allowed: true
    remember_me: true
    verify_email: false
    edit_username_allowed: false
    duplicate_emails_allowed: false
    
    # Session Settings (in seconds)
    sso_session_idle_timeout: 1800        # 30 minutes
    sso_session_max_lifespan: 36000       # 10 hours
    offline_session_idle_timeout: 2592000 # 30 days
    offline_session_max_lifespan: 5184000 # 60 days
    access_token_lifespan: 300            # 5 minutes
    
    # Security Settings
    ssl_required: "external"
    password_policy: "upperCase(1) and length(8) and digits(1) and notUsername"
    revoke_refresh_token: true
    refresh_token_max_reuse: 0
    
    # Internationalization
    supported_locales:
      - "en"
      - "es"
      - "fr"
      - "de"
    default_locale: "en"
    
    # Security Defenses
    security_defenses:
      headers:
        x_frame_options: "SAMEORIGIN"
        content_security_policy: "frame-src 'self'; frame-ancestors 'self'; object-src 'none';"
        x_content_type_options: "nosniff"
        x_robots_tag: "none"
        x_xss_protection: "1; mode=block"
        strict_transport_security: "max-age=31536000; includeSubDomains"
      brute_force:
        permanent_lockout: false
        max_login_failures: 5
        wait_increment_seconds: 60
        quick_login_check_milli_seconds: 1000
        minimum_quick_login_wait_seconds: 60
        max_failure_wait_seconds: 900
        failure_reset_time_seconds: 43200
    
    # Browser Flows
    browser_flow: "browser"
    registration_flow: "registration"
    direct_grant_flow: "direct grant"
    reset_credentials_flow: "reset credentials"
    client_authentication_flow: "clients"

# Optional: SMTP Configuration (if needed, uncomment and configure)
# smtp_server:
#   enabled: true
#   host: "smtp.example.com"
#   port: "587"
#   from: "noreply@example.com"
#   from_display_name: "Keycloak"
#   ssl: false
#   starttls: true
#   username: "smtp-user"
#   password: "smtp-password"
